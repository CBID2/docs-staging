---
title: Determine Your TiDB Size
summary: Learn how to determine the size of your TiDB Cloud cluster.
---

# TiDB のサイズを決定する {#determine-your-tidb-size}

このドキュメントでは、Dedicated Tierクラスタのサイズを決定する方法について説明します。

> **ノート：**
>
> [開発者層クラスタ](/tidb-cloud/select-cluster-tier.md#developer-tier)にはデフォルトのクラスタサイズが付属しており、変更することはできません。

## サイズ TiDB {#size-tidb}

TiDB はコンピューティング専用であり、データを保存しません。水平方向にスケーラブルです。

TiDB のノード サイズとノード数の両方を構成できます。

### TiDB ノードサイズ {#tidb-node-size}

サポートされているノード サイズは次のとおりです。

-   4 vCPU、16 GiB
-   8 vCPU、16 GiB
-   16 vCPU、32 GiB

> **ノート：**
>
> TiDB のノード サイズが**4 vCPU、16 GiB**に設定されている場合は、次の制限に注意してください。
>
> -   TiDB のノード数は 1 または 2 にのみ設定でき、TiKV のノード数は 3 に固定されています。
> -   TiDB は 4 vCPU TiKV でのみ使用できます。
> -   TiFlash は利用できません。

### TiDB ノード数 {#tidb-node-quantity}

高可用性のために、 TiDB Cloudクラスタごとに少なくとも 2 つの TiDB ノードを構成することをお勧めします。

TiDB のサイズを決定する方法の詳細については、 [パフォーマンス リファレンス](#performance-reference)を参照してください。

## サイズ TiKV {#size-tikv}

TiKV はデータの保存を担当します。水平方向にスケーラブルです。

TiKV のノード サイズ、ノード数、およびストレージ サイズを構成できます。

### TiKV ノードサイズ {#tikv-node-size}

サポートされているノード サイズは次のとおりです。

-   4 vCPU、16 GiB
-   8 vCPU、32 GiB
-   8 vCPU、64 GiB
-   16 vCPU、64 GiB

> **ノート：**
>
> TiKV のノード サイズが**4 vCPU、16 GiB**に設定されている場合は、次の制限に注意してください。
>
> -   TiDB のノード数は 1 または 2 にのみ設定でき、TiKV のノード数は 3 に固定されています。
> -   TiKV は 4 vCPU TiDB でのみ使用できます。
> -   TiFlash は利用できません。

### TiKV ノード数 {#tikv-node-quantity}

TiKV ノードの数は**、少なくとも 1 セット (3 つの異なる利用可能なゾーンに 3 つのノード) で**ある必要があります。

TiDB Cloudは、耐久性と高可用性を実現するために、選択したリージョン内のすべてのアベイラビリティ ゾーン (少なくとも 3 つ) に TiKV ノードを均等にデプロイします。典型的な 3 レプリカ セットアップでは、データはすべてのアベイラビリティ ゾーンの TiKV ノード間で均等に分散され、各 TiKV ノードのディスクに永続化されます。

> **ノート：**
>
> TiDBクラスタをスケーリングすると、3 つのアベイラビリティーゾーンのノードが同時に増減します。ニーズに基づいて TiDBクラスタをスケールインまたはスケールアウトする方法については、 [TiDB クラスターをスケーリングする](/tidb-cloud/scale-tidb-cluster.md)を参照してください。

TiKV ノードの最小数: `ceil(compressed size of your data ÷ one TiKV capacity) × the number of replicas`

MySQL ダンプ ファイルのサイズが 5 TB で、TiDB の圧縮率が 70% であると仮定すると、必要なストレージは 3584 GB です。

たとえば、AWS 上の各 TiKV ノードのストレージ サイズを 1024 GB として構成する場合、必要な TiKV ノードの数は次のようになります。

TiKV ノードの最小数: `ceil(3584 ÷ 1024) × 3 = 12`

TiKV サイズを決定する方法の詳細については、 [パフォーマンス リファレンス](#performance-reference)を参照してください。

### TiKV ストレージ サイズ {#tikv-storage-size}

-   8 vCPU または 16 vCPU TiKV は、最大 4 TiB のストレージ容量をサポートします。
-   4 vCPU TiKV は、最大 2 TiB のストレージ容量をサポートします。

> **ノート：**
>
> クラスタの作成後に TiKV ストレージ サイズを減らすことはできません。

## サイズ TiFlash {#size-tiflash}

TiFlash は TiKV からのデータをリアルタイムで同期し、すぐにリアルタイム分析ワークロードをサポートします。水平方向にスケーラブルです。

TiFlash のノード サイズ、ノード数、およびストレージ サイズを設定できます。

### TiFlash ノードサイズ {#tiflash-node-size}

サポートされているノード サイズは次のとおりです。

-   8 vCPU、64 GiB
-   16 vCPU、128 GiB

TiDB または TiKV の vCPU サイズが**4 vCPU、16 GiB に**設定されている場合、TiFlash は使用できないことに注意してください。

### TiFlash ノード数 {#tiflash-node-quantity}

TiDB Cloudは、リージョン内の異なるアベイラビリティ ゾーンに TiFlash ノードを均等にデプロイします。各TiDB Cloudクラスタで少なくとも 2 つの TiFlash ノードを構成し、実稼働環境での高可用性のためにデータの少なくとも 2 つのレプリカを作成することをお勧めします。

TiFlash ノードの最小数は、特定のテーブルの TiFlash レプリカ数によって異なります。

TiFlash ノードの最小数: `min((compressed size of table A * replicas for table A + compressed size of table B * replicas for table B) / size of each TiFlash capacity, max(replicas for table A, replicas for table B))`

たとえば、AWS 上の各 TiFlash ノードのストレージ サイズを 1024 GB に設定し、テーブル A に 2 つのレプリカ (圧縮サイズは 800 GB) とテーブル B に 1 つのレプリカ (圧縮サイズは 100 GB) を設定すると、必要な TiFlash ノードの数は次のとおりです。

TiFlash ノードの最小数: `min((800 GB * 2 + 100 GB * 1) / 1024 GB, max(2, 1)) ≈ 2`

### TiFlash ストレージ サイズ {#tiflash-storage-size}

TiFlash は最大 2 TiB のストレージ容量をサポートします。

> **ノート：**
>
> クラスタの作成後に TiFlash ストレージのサイズを減らすことはできません。

## パフォーマンス リファレンス {#performance-reference}

このセクションでは、5 つの一般的な TiDBクラスタスケールの[TPC-C](https://www.tpc.org/tpcc/)と[シスベンチ](https://github.com/akopytov/sysbench)のパフォーマンス テスト結果を提供します。これは、クラスタサイズを決定する際の参考として使用できます。

テスト環境：

-   TiDB バージョン: v5.4.0
-   倉庫: 5000
-   データサイズ：366G
-   テーブルサイズ: 10000000
-   テーブル数: 16

次のいずれかのスケールをクリックして、パフォーマンス データを確認できます。

<details><summary>TiDB: 4 vCPU * 2; TiKV: 4 vCPU * 3</summary>

-   低レイテンシで最適なパフォーマンス

    TPC-C パフォーマンス:

    | 取引モデル | スレッド | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ---- | ------ | ------ | ------------ |
    | TPCC  | 300  | 14,532 | 13,137 | 608          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド | TPS    | QPS    | レイテンシー (ミリ秒) |
    | ---------- | ---- | ------ | ------ | ------------ |
    | 入れる        | 300  | 8,848  | 8,848  | 36           |
    | ポイントセレクト   | 600  | 46,224 | 46,224 | 13           |
    | 読み書き       | 150  | 719    | 14,385 | 209          |
    | インデックスを更新  | 150  | 4,346  | 4,346  | 35           |
    | 非インデックスの更新 | 600  | 13,603 | 13,603 | 44           |

-   最大 TPS と QPS

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ----- | ------ | ------ | ------------ |
    | TPCC  | 1,200 | 15,208 | 13,748 | 2,321        |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS    | QPS    | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------ | ------ | ------------ |
    | 入れる        | 1,500 | 11,601 | 11,601 | 129          |
    | ポイントセレクト   | 600   | 46,224 | 46,224 | 13           |
    | 読み書き       | 150   | 14,385 | 719    | 209          |
    | インデックスを更新  | 1,200 | 6,526  | 6,526  | 184          |
    | 非インデックスの更新 | 1,500 | 14,351 | 14,351 | 105          |

</details>

<details><summary>TiDB: 8 vCPU * 2; TiKV: 8 vCPU * 3</summary>

-   低レイテンシで最適なパフォーマンス

    TPC-C パフォーマンス:

    | 取引モデル | スレッド | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ---- | ------ | ------ | ------------ |
    | TPCC  | 600  | 32,266 | 29,168 | 548          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS    | QPS    | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------ | ------ | ------------ |
    | 入れる        | 600   | 17,831 | 17,831 | 34           |
    | ポイントセレクト   | 600   | 93,287 | 93,287 | 6            |
    | 読み書き       | 300   | 29,729 | 1,486  | 202          |
    | インデックスを更新  | 300   | 9,415  | 9,415  | 32           |
    | 非インデックスの更新 | 1,200 | 31,092 | 31,092 | 39           |

-   最大 TPS と QPS

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ----- | ------ | ------ | ------------ |
    | TPCC  | 1,200 | 33,394 | 30,188 | 1,048人       |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS    | QPS    | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------ | ------ | ------------ |
    | 入れる        | 2,000 | 23,633 | 23,633 | 84           |
    | ポイントセレクト   | 600   | 93,287 | 93,287 | 6            |
    | 読み書き       | 600   | 30,464 | 1,523  | 394          |
    | インデックスを更新  | 2,000 | 15,146 | 15,146 | 132          |
    | 非インデックスの更新 | 2,000 | 34,505 | 34,505 | 58           |

</details>

<details><summary>TiDB: 8 vCPU * 4; TiKV: 8 vCPU * 6</summary>

-   低レイテンシで最適なパフォーマンス

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ----- | ------ | ------ | ------------ |
    | TPCC  | 1,200 | 62,918 | 56,878 | 310          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS     | QPS     | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------- | ------- | ------------ |
    | 入れる        | 1,200 | 33,892  | 33,892  | 23           |
    | ポイントセレクト   | 1,200 | 185,574 | 181,255 | 4            |
    | 読み書き       | 600   | 59,160  | 2,958   | 127          |
    | インデックスを更新  | 600   | 18,735  | 18,735  | 21           |
    | 非インデックスの更新 | 2,400 | 60,629  | 60,629  | 23           |

-   最大 TPS と QPS

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ----- | ------ | ------ | ------------ |
    | TPCC  | 2,400 | 65,452 | 59,169 | 570          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS     | QPS     | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------- | ------- | ------------ |
    | 入れる        | 4,000 | 47,029  | 47,029  | 43           |
    | ポイントセレクト   | 1,200 | 185,574 | 181,255 | 4            |
    | 読み書き       | 1,200 | 60,624  | 3,030   | 197          |
    | インデックスを更新  | 4,000 | 30,140  | 30,140  | 67           |
    | 非インデックスの更新 | 4,000 | 68,664  | 68,664  | 29           |

</details>

<details><summary>TiDB: 16 vCPU * 2; TiKV: 16 vCPU * 3</summary>

-   低レイテンシで最適なパフォーマンス

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ----- | ------ | ------ | ------------ |
    | TPCC  | 1,200 | 67,941 | 61,419 | 540          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS     | QPS     | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------- | ------- | ------------ |
    | 入れる        | 1,200 | 35,096  | 35,096  | 34           |
    | ポイントセレクト   | 1,200 | 228,600 | 228,600 | 5            |
    | 読み書き       | 600   | 73,150  | 3,658   | 164          |
    | インデックスを更新  | 600   | 18,886  | 18,886  | 32           |
    | 非インデックスの更新 | 2,000 | 63,837  | 63,837  | 31           |

-   最大 TPS と QPS

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC   | QPS    | レイテンシー (ミリ秒) |
    | ----- | ----- | ------ | ------ | ------------ |
    | TPCC  | 1,200 | 67,941 | 61,419 | 540          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS     | QPS     | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------- | ------- | ------------ |
    | 入れる        | 2,000 | 43,338  | 43,338  | 46           |
    | ポイントセレクト   | 1,200 | 228,600 | 228,600 | 5            |
    | 読み書き       | 1,200 | 73,631  | 3,682   | 326          |
    | インデックスを更新  | 3,000 | 29,576  | 29,576  | 101          |
    | 非インデックスの更新 | 3,000 | 64,624  | 64,624  | 46           |

</details>

<details><summary>TiDB: 16 vCPU * 4; TiKV: 16 vCPU * 6</summary>

-   低レイテンシで最適なパフォーマンス

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC    | QPS     | レイテンシー (ミリ秒) |
    | ----- | ----- | ------- | ------- | ------------ |
    | TPCC  | 2,400 | 133,164 | 120,380 | 305          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS     | QPS     | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------- | ------- | ------------ |
    | 入れる        | 2,400 | 69,139  | 69,139  | 22           |
    | ポイントセレクト   | 2,400 | 448,056 | 448,056 | 4            |
    | 読み書き       | 1,200 | 145,568 | 7,310   | 97           |
    | インデックスを更新  | 1,200 | 36,638  | 36,638  | 20           |
    | 非インデックスの更新 | 4,000 | 125,129 | 125,129 | 17           |

-   最大 TPS と QPS

    TPC-C パフォーマンス:

    | 取引モデル | スレッド  | tpmC    | QPS     | レイテンシー (ミリ秒) |
    | ----- | ----- | ------- | ------- | ------------ |
    | TPCC  | 2,400 | 133,164 | 120,380 | 305          |

    Sysbench OLTP のパフォーマンス:

    | 取引モデル      | スレッド  | TPS     | QPS     | レイテンシー (ミリ秒) |
    | ---------- | ----- | ------- | ------- | ------------ |
    | 入れる        | 4,000 | 86,242  | 86,242  | 25           |
    | ポイントセレクト   | 2,400 | 448,056 | 448,056 | 4            |
    | 読み書き       | 2,400 | 146,526 | 7,326   | 172          |
    | インデックスを更新  | 6,000 | 58,856  | 58,856  | 51           |
    | 非インデックスの更新 | 6,000 | 128,601 | 128,601 | 24           |

</details>
